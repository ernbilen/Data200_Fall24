<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Chapter 23</title>
    <meta charset="utf-8" />
    <meta name="author" content="Eren Bilen" />
    <meta name="date" content="2023-01-19" />
    <script src="chp23-APIs_files/header-attrs-2.11/header-attrs.js"></script>
    <link href="chp23-APIs_files/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="chp23-APIs_files/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Chapter 23
## RESTful Application Programming Interfaces
### Eren Bilen
### 2023-01-19

---

#  Motivation 

+ Most of the time, data analytics professionals work with data that comes from their employer’s internal systems.
	+ However, it is common to utilize third party data in order to enrich an analysis.
	+ Many companies and organizations offer their data through an Application Programming Interface (API): weather data, stock prices, crime statistics, etc.
	+ APIs allow developers and end users to access data in a secure and standardized way.

---
#  Why Offer Data Through an API? 

+ Open Data: Often collected directly by local, regional, and national governments or organizations and are provided openly as a public service.
	+ Service for Profit: Some providers are purveyors of data, which they gather and curate and then, charge for access to the data.

---
#  Commonalities with Web Scraping 

+ Intention: In web scraping, web pages are designed to be viewed primarily in browsers, and data extraction is often a repurposing of the data contained therein.  In API services, the provider is intending to provide the data itself.
	+ Format: In web scraping, the format is HTML, which was not intended for data exchange.  In API services, the format is consistent with the various data models covered during the semester: CSV, JSON, and XML.

---
#  Web Scraping vs APIs 

+ When web scraping, the acquired HTML is often static, already consisting of a textual HTML file in the file system of the web server.
	+ In API service providers, the data is often dynamic, being generated on the fly based on a request.
	+ In this regard, API service providers are more akin to the relational database systems that, in response to an SQL request, dynamically access the back end and respond with the requested data.
	+ Whenever there is a choice, an application should use an API rather than performing web scraping.

---
#  REST APIs 

+ REST stands for “Representational State Transfer.”
	+ REST defines a set of functions like GET, PUT, DELETE, etc. that clients can use to access server data. Clients and servers exchange data using HTTP (which is a protocol for fetching resources such as HTML documents).
	+ One of the guiding principals is that the API is stateless , which means that a data request is “packaged together” in a unit, so the functionality is provided independent of any prior interaction

---
#  HTTP 

+ Recall that HTTP stands for Hyper Text Transfer Protocol and forms the foundation of the World Wide Web.
HTTP Request / Response
+ Communication between clients and servers is done by requests and responses :
+ A client (a browser) sends an HTTP request to the web
	+ A web server receives the request
	+ The server runs an application to process the request
	+ The server returns an HTTP response (output) to the browser
	+ The client (the browser) receives the response

---
#  HTTP for REST API Requests 

+ RESTful APIs use the existing application level protocol of HTTP for making their requests and use the HTTP response message for carrying the outcome/status of the request and, if successful, the data resulting from the request.

---
#  The Movie Database (TMDB) 

+ The Movie Database (TMDB) is a community-built movie and TV database. Every piece of data has been added by the community dating back to 2008.
 https://www.themoviedb.org/
+ Millions of people use the service daily
[https://www.themoviedb.org/](https://www.themoviedb.org/)

---
#  API Documentation 

+ Before accessing an API, the first step is to read the API documentation.
	+ This step is crucial because in order to know what data to pull, how to pull it, and how to unpack it, you need some understanding of the API and how it is structured.
	+ TMDB API documentation can be found here:
https://developers.themoviedb.org/3/getting-started/introduction
[https://developers.themoviedb.org/3/getting-started/introduction](https://developers.themoviedb.org/3/getting-started/introduction)

---
#  API Key 

+ As with most APIs, the TMDB APIs are not available for anonymous access but require requests to identify themselves as belonging to a particular application that has been previously registered.
	+ In the TMDB database, all accesses require the request to provide an authenticating API key.
	+ The API key is obtained by an application developer registering as a TMDB user, complete with a username and password, on the TMDB site.
	+ The resultant API key is then integrated into the application, usually by storing the key in a file or database so that the application can securely obtain the key when needed.

---
#  Get Movie Detail 

+ In order to find out whether a movie belongs to a collection using the TMDB API, we need to use the “get movie detail” query to pull the movie detail for each movie.
	+ The documentation for this query can be found here:
https://developers.themoviedb.org/3/movies/get-movie-details
+ The basic query looks like this:
https://api.themoviedb.org/3/movie/{movie_id}?api_key=&lt;&lt;api_key&gt;&gt;&amp;language=en-US
[https://developers.themoviedb.org/3/movies/get-movie-details](https://developers.themoviedb.org/3/movies/get-movie-details)

---
#  Query Movie Information by ID 

+ By substituting “API key” below with your API key (“1a2b3c4d5e” for demo purposes) and providing a movie id of interest (using “414906”, The Batman, as an example here), we can form an API query like this:
https://api.themoviedb.org/3/movie/ 414906 ?api_key=1a2b3c4d5e&amp;language=en-US

---
#  Understanding the Result 

{"adult":false," backdrop_path ":"/tRS6jvPM9qPrrnx2KRp3ew96Yot.jpg","belongs_to_collection":{"id":948485,"name":"The Batman Collection"," poster_path ":"/tuzKA9K5Ae9IzaA0R9oAgbyhAI3.jpg","backdrop_path":"/qS2ViQwlWUECiAdkIuEaJZoq0QW.jpg"},"budget":185000000,"genres":[{"id":80,"name":"Crime"},{"id":9648,"name":"Mystery"},{"id":53,"name":"Thriller"}]," homepage":"https ://www.thebatman.com","id":414906,"imdb_id":"tt1877830","original_language":"en","original_title":"The Batman","overview":"In his second year of fighting crime, Batman uncovers corruption in Gotham City that connects to his own family while facing a serial killer known as the Riddler.","popularity":9937.303,"poster_path":"/74xTEgt7R36Fpooo50r9T25onhq.jpg","production_companies":[{"id":101405,"logo_path":null,"name":"6th &amp; Idaho","origin_country":"US "},{"id":119245,"logo_path":null,"name":"Dylan Clark Productions","origin_country":"US "},{"id":128064,"logo_path":"/13F3Jf7EFAcREU0xzZqJnVnyGXu.png","name":"DC Films","origin_country":"US "},{"id":174,"logo_path":"/IuAlhI9eVC9Z8UQWOIDdWRKSEJ.png","name":"Warner Bros. Pictures","origin_country":"US "}]," production_countries ":[{"iso_3166_1":"US","name":"United States of America"}],"release_date":"2022-03-01","revenue":759793000,"runtime":176,"spoken_languages":[{"english_name":"English","iso_639_1":"en","name":"English"}]," status":"Released","tagline":"Unmask the truth.","title":"The Batman","video":false,"vote_average":7.8,"vote_count":4129}

---
#  Display JSON with util 

+ Suppose we save this output to batman.json .
	+ We can display the information in a more readably format using util.print_data :
with open(“ batman.json ") as f:
out = json.load (f)
util.print_data (out, nlines =40)

---


---
#  Search for Movies 

https://developers.themoviedb.org/3/search/search-movies
[https://developers.themoviedb.org/3/search/search-movies](https://developers.themoviedb.org/3/search/search-movies)

---
#  creds.json 

{
" tmdb ":
{ "protocol": "https",
"location": "api.themoviedb.org",
" apikey ": “ your_key_here "
}
}
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create();
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
